<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026í•™ë…„ë„ ìˆ˜ëŠ¥ í™˜ì‚°ì ìˆ˜ ë°°ì¹˜í‘œ</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 10px;
        }

        header h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .input-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .input-section h2 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #1a237e;
            border-bottom: 2px solid #e8eaf6;
            padding-bottom: 10px;
        }

        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .score-input {
            display: flex;
            flex-direction: column;
        }

        .score-input label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 5px;
        }

        .score-input input, .score-input select {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .score-input input:focus, .score-input select:focus {
            outline: none;
            border-color: #3949ab;
        }

        .score-input input[type="number"] {
            background: #fffde7;
        }

        .filter-section {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-group label {
            font-size: 0.9rem;
            color: #666;
        }

        .filter-group input[type="text"] {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 150px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #3949ab;
            color: white;
        }

        .btn-primary:hover {
            background: #1a237e;
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 25px;
            background: white;
            border: none;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            font-size: 1rem;
            color: #666;
            transition: all 0.3s;
        }

        .tab.active {
            background: #3949ab;
            color: white;
        }

        .tab:hover:not(.active) {
            background: #e8eaf6;
        }

        .tab .count {
            font-size: 0.8rem;
            margin-left: 5px;
            opacity: 0.8;
        }

        .results-section {
            background: white;
            border-radius: 0 10px 10px 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .results-count {
            font-size: 0.9rem;
            color: #666;
        }

        .sort-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sort-group select {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .results-table th {
            background: #f5f5f5;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #ddd;
            position: sticky;
            top: 0;
            cursor: pointer;
        }

        .results-table th:hover {
            background: #e8eaf6;
        }

        .results-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #eee;
        }

        .results-table tr:hover {
            background: #f8f9fa;
        }

        .results-table tr.highlight {
            background: #e3f2fd;
        }

        .status-safe {
            background: #c8e6c9;
            color: #2e7d32;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }

        .status-appropriate {
            background: #bbdefb;
            color: #1565c0;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }

        .status-expected {
            background: #ffe0b2;
            color: #ef6c00;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }

        .status-challenge {
            background: #ffcdd2;
            color: #c62828;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }

        .status-difficult {
            background: #f5f5f5;
            color: #757575;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            display: inline-block;
        }

        .track-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .track-natural {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .track-humanities {
            background: #fff3e0;
            color: #ef6c00;
        }

        .track-combined {
            background: #e3f2fd;
            color: #1565c0;
        }

        .my-score {
            font-weight: 700;
            color: #1a237e;
            font-size: 1rem;
        }

        .score-cell {
            font-family: 'Monaco', 'Consolas', monospace;
        }

        .score-diff {
            font-size: 0.85rem;
            font-weight: 600;
        }

        .score-diff.positive {
            color: #2e7d32;
        }

        .score-diff.negative {
            color: #c62828;
        }

        .table-container {
            max-height: 600px;
            overflow-y: auto;
        }

        .no-results {
            text-align: center;
            padding: 50px;
            color: #999;
        }

        .legend {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
            font-size: 0.85rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .notice {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 5px 5px 0;
            font-size: 0.9rem;
        }

        .notice strong {
            color: #e65100;
        }

        .score-summary {
            background: #e3f2fd;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
        }

        .score-summary-item {
            display: flex;
            flex-direction: column;
        }

        .score-summary-item .label {
            font-size: 0.8rem;
            color: #666;
        }

        .score-summary-item .value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1a237e;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: #999;
            font-size: 0.85rem;
        }

        @media (max-width: 768px) {
            .score-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .filter-section {
                flex-direction: column;
                align-items: stretch;
            }

            .results-table {
                font-size: 0.8rem;
            }

            .results-table th, .results-table td {
                padding: 8px 4px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>2026í•™ë…„ë„ ìˆ˜ëŠ¥ í™˜ì‚°ì ìˆ˜ ë°°ì¹˜í‘œ</h1>
            <p>2026 ìˆ˜ëŠ¥ ì‹¤ì±„ì  ê¸°ì¤€ | ì›ë³¸: ë² í…”ê¸°ìš°ìŠ¤(Betelgeuse058.tistory.com)</p>
        </header>

        <div class="notice">
            <strong>ì•ˆë‚´:</strong> ì´ ë°°ì¹˜í‘œëŠ” ê° ëŒ€í•™ì˜ 2025í•™ë…„ë„ ì…ì‹œê²°ê³¼(70%ì»·)ë¥¼ 2026í•™ë…„ë„ ìˆ˜ëŠ¥ ê¸°ì¤€ìœ¼ë¡œ ì—­í™˜ì‚°í•œ ìë£Œì…ë‹ˆë‹¤.
            ì‹¤ì œ ì§€ì› ì‹œì—ëŠ” ê° ëŒ€í•™ì˜ ëª¨ì§‘ìš”ê°•ì„ ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”.
        </div>

        <div class="input-section">
            <h2>ë‚´ ì ìˆ˜ ì…ë ¥</h2>
            <p style="font-size: 0.9rem; color: #666; margin-bottom: 15px;">ğŸ’¡ ëŒ€í•™ì— ë”°ë¼ í‘œì ìˆ˜ ë˜ëŠ” ë°±ë¶„ìœ„ë¥¼ ì…ë ¥ë°›ìŠµë‹ˆë‹¤. ê°€ëŠ¥í•˜ë©´ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>

            <div class="score-grid">
                <div class="score-input">
                    <label>êµ­ì–´ í‘œì ìˆ˜</label>
                    <input type="number" id="korean" placeholder="131" min="0" max="200">
                </div>
                <div class="score-input">
                    <label>êµ­ì–´ ë°±ë¶„ìœ„</label>
                    <input type="number" id="koreanPct" placeholder="85" min="0" max="100">
                </div>
                <div class="score-input">
                    <label>ìˆ˜í•™ í‘œì ìˆ˜</label>
                    <input type="number" id="math" placeholder="140" min="0" max="200">
                </div>
                <div class="score-input">
                    <label>ìˆ˜í•™ ë°±ë¶„ìœ„</label>
                    <input type="number" id="mathPct" placeholder="92" min="0" max="100">
                </div>
                <div class="score-input">
                    <label>íƒêµ¬1 í‘œì ìˆ˜</label>
                    <input type="number" id="tamgu1" placeholder="68" min="0" max="100">
                </div>
                <div class="score-input">
                    <label>íƒêµ¬1 ë°±ë¶„ìœ„</label>
                    <input type="number" id="tamgu1Pct" placeholder="96" min="0" max="100">
                </div>
                <div class="score-input">
                    <label>íƒêµ¬2 í‘œì ìˆ˜</label>
                    <input type="number" id="tamgu2" placeholder="65" min="0" max="100">
                </div>
                <div class="score-input">
                    <label>íƒêµ¬2 ë°±ë¶„ìœ„</label>
                    <input type="number" id="tamgu2Pct" placeholder="92" min="0" max="100">
                </div>
                <div class="score-input">
                    <label>ì˜ì–´ ë“±ê¸‰</label>
                    <select id="english">
                        <option value="1">1ë“±ê¸‰</option>
                        <option value="2">2ë“±ê¸‰</option>
                        <option value="3">3ë“±ê¸‰</option>
                        <option value="4">4ë“±ê¸‰</option>
                        <option value="5">5ë“±ê¸‰</option>
                    </select>
                </div>
                <div class="score-input">
                    <label>í•œêµ­ì‚¬ ë“±ê¸‰</label>
                    <select id="history">
                        <option value="1">1ë“±ê¸‰</option>
                        <option value="2">2ë“±ê¸‰</option>
                        <option value="3">3ë“±ê¸‰</option>
                        <option value="4">4ë“±ê¸‰</option>
                        <option value="5">5ë“±ê¸‰</option>
                    </select>
                </div>
                <div class="score-input">
                    <label>íƒêµ¬ ê³„ì—´</label>
                    <select id="tamguType">
                        <option value="science">ê³¼í•™íƒêµ¬</option>
                        <option value="social">ì‚¬íšŒíƒêµ¬</option>
                    </select>
                </div>
            </div>

            <div class="filter-section">
                <div class="filter-group">
                    <label>ê³„ì—´:</label>
                    <select id="trackFilter">
                        <option value="all">ì „ì²´</option>
                        <option value="ìì—°">ìì—°</option>
                        <option value="ì¸ë¬¸">ì¸ë¬¸</option>
                        <option value="í†µí•©">í†µí•©</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>í•©ê²©ê°€ëŠ¥ì„±:</label>
                    <select id="probabilityFilter">
                        <option value="all">ì „ì²´</option>
                        <option value="safe">ì•ˆì • ì´ìƒ</option>
                        <option value="appropriate">ì ì • ì´ìƒ</option>
                        <option value="expected">ì†Œì‹  ì´ìƒ</option>
                        <option value="challenge">ë„ì „ ì´ìƒ</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>ëŒ€í•™:</label>
                    <input type="text" id="universitySearch" placeholder="ëŒ€í•™ëª…">
                </div>
                <div class="filter-group">
                    <label>í•™ê³¼:</label>
                    <input type="text" id="departmentSearch" placeholder="í•™ê³¼ëª…">
                </div>
                <button class="btn btn-primary" onclick="calculateScores()">ë¶„ì„í•˜ê¸°</button>
            </div>
        </div>

        <div id="scoreSummary" class="score-summary" style="display: none;">
            <div class="score-summary-item">
                <span class="label">í‘œì¤€ì ìˆ˜ í•©ê³„</span>
                <span class="value" id="totalScore">-</span>
            </div>
            <div class="score-summary-item">
                <span class="label">êµ­ìˆ˜íƒ í‰ê· </span>
                <span class="value" id="avgScore">-</span>
            </div>
            <div class="score-summary-item">
                <span class="label">ì§€ì› ê°€ëŠ¥ í•™ê³¼</span>
                <span class="value" id="possibleCount">-</span>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" data-gun="ê°€" onclick="switchTab('ê°€')">ê°€êµ° <span class="count" id="countGa">0</span></button>
            <button class="tab" data-gun="ë‚˜" onclick="switchTab('ë‚˜')">ë‚˜êµ° <span class="count" id="countNa">0</span></button>
            <button class="tab" data-gun="ë‹¤" onclick="switchTab('ë‹¤')">ë‹¤êµ° <span class="count" id="countDa">0</span></button>
        </div>

        <div class="results-section">
            <div class="results-header">
                <h3 id="resultsTitle">ê°€êµ° ë°°ì¹˜í‘œ</h3>
                <div class="sort-group">
                    <label>ì •ë ¬:</label>
                    <select id="sortBy" onchange="renderResults()">
                        <option value="probability">í•©ê²©ê°€ëŠ¥ì„±ìˆœ</option>
                        <option value="score">í™˜ì‚°ì ìˆ˜ìˆœ</option>
                        <option value="university">ëŒ€í•™ëª…ìˆœ</option>
                    </select>
                </div>
            </div>

            <div class="table-container">
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>ëŒ€í•™</th>
                            <th>í•™ê³¼</th>
                            <th>ê³„ì—´</th>
                            <th>ë‚´ í™˜ì‚°ì ìˆ˜</th>
                            <th>ì•ˆì •</th>
                            <th>ì ì •</th>
                            <th>ì˜ˆìƒì»·</th>
                            <th>ë„ì „</th>
                            <th>í•©ê²© ê°€ëŠ¥ì„±</th>
                            <th>ë°˜ì˜ë¹„ìœ¨</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody">
                        <tr>
                            <td colspan="10" class="no-results">ì ìˆ˜ë¥¼ ì…ë ¥í•˜ê³  [ë¶„ì„í•˜ê¸°] ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="legend">
                <div class="legend-item"><span class="status-safe">ì•ˆì •</span> í•©ê²© í™•ë¥  90% ì´ìƒ</div>
                <div class="legend-item"><span class="status-appropriate">ì ì •</span> í•©ê²© í™•ë¥  70% ì´ìƒ</div>
                <div class="legend-item"><span class="status-expected">ì†Œì‹ </span> í•©ê²© í™•ë¥  40% ì´ìƒ</div>
                <div class="legend-item"><span class="status-challenge">ë„ì „</span> í•©ê²© í™•ë¥  10% ì´ìƒ</div>
                <div class="legend-item"><span class="status-difficult">ì–´ë ¤ì›€</span> í•©ê²© í™•ë¥  10% ë¯¸ë§Œ</div>
            </div>
        </div>

        <footer>
            <p>ë³¸ ìë£ŒëŠ” ë² í…”ê¸°ìš°ìŠ¤ë‹˜ì˜ í™˜ì‚°ì ìˆ˜ ì—‘ì…€ë°°ì¹˜í‘œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
            <p>ì°¸ê³ ìš©ì´ë©°, ì‹¤ì œ ì…ì‹œ ê²°ê³¼ì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </footer>
    </div>

    <script>
        let universities = [];
        let formulas = {};
        let conversion = {};
        let deductions = {};
        let currentGun = 'ê°€';
        let calculatedResults = [];

        // ë°ì´í„° ë¡œë“œ
        async function loadData() {
            try {
                const timestamp = new Date().getTime();
                const [univRes, formulaRes, convRes, deductRes] = await Promise.all([
                    fetch(`universities.json?v=${timestamp}`),
                    fetch(`formulas_extracted.json?v=${timestamp}`),
                    fetch(`conversion.json?v=${timestamp}`),
                    fetch(`deduction_tables.json?v=${timestamp}`)
                ]);

                universities = await univRes.json();
                formulas = await formulaRes.json();
                conversion = await convRes.json();
                deductions = await deductRes.json();

                console.log(`ë°ì´í„° ë¡œë“œ ì™„ë£Œ: ${universities.length}ê°œ í•™ê³¼`);
                console.log(`ê³µì‹ ë¡œë“œ ì™„ë£Œ: ${Object.keys(formulas).length}ê°œ ê³µì‹`);
                console.log(`ê°ì  í…Œì´ë¸” ë¡œë“œ ì™„ë£Œ: ${Object.keys(deductions).length}ê°œ`);

                // ì´ˆê¸° ê°œìˆ˜ í‘œì‹œ
                document.getElementById('countGa').textContent = universities.filter(u => u.gun === 'ê°€').length;
                document.getElementById('countNa').textContent = universities.filter(u => u.gun === 'ë‚˜').length;
                document.getElementById('countDa').textContent = universities.filter(u => u.gun === 'ë‹¤').length;
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('resultsBody').innerHTML =
                    '<tr><td colspan="10" class="no-results">ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨. ë¡œì»¬ ì„œë²„ì—ì„œ ì‹¤í–‰í•´ì£¼ì„¸ìš”.<br><code>python3 -m http.server 8080</code></td></tr>';
            }
        }

        // ë³€í™˜í‘œì¤€ì ìˆ˜ ê°€ì ¸ì˜¤ê¸°
        function getConvertedScore(percentile, university, tamguType) {
            if (!conversion[percentile]) return null;

            const univMappings = {
                'ì—°ì„¸ëŒ€': 'ì—°ì„¸ëŒ€',
                'ê³ ë ¤ëŒ€': 'ê³ ë ¤ëŒ€',
                'ì„œê°•ëŒ€': 'ì„œê°• ìì—°',
                'ì„±ê· ê´€ëŒ€': 'ì„±ê· ê´€ëŒ€',
                'í•œì–‘ëŒ€': 'í•œì–‘ëŒ€',
                'ì¤‘ì•™ëŒ€': 'ì¤‘ì•™ëŒ€',
                'ê²½í¬ëŒ€': 'ê²½í¬ëŒ€',
                'ì´í™”ì—¬ëŒ€': 'ì´í™”ì—¬ëŒ€',
                'ì„œìš¸ì‹œë¦½ëŒ€': 'ì„œìš¸ì‹œë¦½ëŒ€',
                'ê±´êµ­ëŒ€': 'ê±´êµ­ëŒ€',
                'ë™êµ­ëŒ€': 'ë™êµ­ëŒ€',
                'ìˆ™ëª…ì—¬ëŒ€': 'ìˆ™ëª…ì—¬ëŒ€',
                'í•œêµ­ì™¸ëŒ€': 'í•œêµ­ì™¸ëŒ€',
                'ì•„ì£¼ëŒ€': 'ì•„ì£¼ëŒ€',
                'ì¸í•˜ëŒ€': 'ì¸í•˜ ìì—°'
            };

            let convUniv = univMappings[university] || 'ì—°ì„¸ëŒ€';
            if (!conversion[percentile][convUniv]) {
                convUniv = 'ì—°ì„¸ëŒ€';
            }

            const scores = conversion[percentile][convUniv];
            if (!scores) return null;

            return tamguType === 'science' ? scores.science : scores.social;
        }

        // í™˜ì‚°ì ìˆ˜ ê³„ì‚° (ì—‘ì…€ ìˆ˜ì‹ ì™„ì „ ì¬í˜„)
        function calculateScore(univ, korean, koreanPct, math, mathPct, tamgu1, tamgu2, tamgu1Pct, tamgu2Pct, tamguType, english, history) {
            const formula = formulas[univ.formulaId];
            if (!formula) {
                // ê¸°ë³¸ ê³„ì‚°
                return korean * 0.25 + math * 0.35 + (tamgu1 + tamgu2) * 0.2;
            }

            // scoreMethodì— ë”°ë¼ ì ìˆ˜ ê²°ì •
            let k = korean, m = math;
            
            if (univ.scoreMethod === 'ë°±ë¶„ìœ„') {
                // ë°±ë¶„ìœ„ë§Œ ë°›ëŠ” ëŒ€í•™
                k = koreanPct || korean;
                m = mathPct || math;
            } else if (univ.scoreMethod === 'í‘œì /ë§Œì ') {
                // í‘œì  ë˜ëŠ” ë°±ë¶„ìœ„ - ë°±ë¶„ìœ„ ìš°ì„ 
                k = koreanPct || korean;
                m = mathPct || math;
            } else {
                // í‘œì  ë°›ëŠ” ëŒ€í•™ (ê¸°ë³¸)
                k = korean;
                m = math;
            }

            let t1 = tamgu1, t2 = tamgu2;

            // ë³€í™˜í‘œì¤€ì ìˆ˜ ì ìš©
            if (univ.tamguMethod === 'ë³€í‘œ') {
                const conv1 = getConvertedScore(tamgu1Pct, univ.university, tamguType);
                const conv2 = getConvertedScore(tamgu2Pct, univ.university, tamguType);
                if (conv1) t1 = conv1;
                if (conv2) t2 = conv2;
            }

            // ğŸ”¥ ì—‘ì…€ ìˆ˜ì‹ ì™„ì „ ì¬í˜„
            // êµ­ì–´ = êµ­ì–´ì…ë ¥ê°’ Ã— êµ­ì–´ê³„ìˆ˜
            // ìˆ˜í•™ = ìˆ˜í•™ì…ë ¥ê°’ Ã— ìˆ˜í•™ê³„ìˆ˜
            // íƒêµ¬1 = íƒêµ¬ì…ë ¥ê°’ Ã— íƒêµ¬ê³„ìˆ˜ + íƒêµ¬ë³´ì •ê°’
            // íƒêµ¬2 = íƒêµ¬ì…ë ¥ê°’ Ã— íƒêµ¬ê³„ìˆ˜ + íƒêµ¬ë³´ì •ê°’
            
            const koreanScore = k * formula.koreanCoef;
            const mathScore = m * formula.mathCoef;
            const tamgu1Score = t1 * formula.tamguCoef + formula.tamguBonus;
            const tamgu2Score = t2 * formula.tamguCoef + formula.tamguBonus;
            
            // ì˜ì–´/í•œêµ­ì‚¬ ê°ì  ì¶”ê°€
            let englishScore = 0;
            let historyScore = 0;
            
            const deduction = deductions[univ.formulaId];
            if (deduction) {
                // ì˜ì–´ ê°ì  (ë“±ê¸‰ë³„)
                englishScore = deduction.englishDeduction || 0;
                
                // í•œêµ­ì‚¬ ê°ì  (ë“±ê¸‰ë³„)
                if (history >= 1 && history <= 9) {
                    historyScore = deduction.historyDeductions[history - 1] || 0;
                }
            }
            
            // ìµœì¢… í™˜ì‚°ì ìˆ˜ = êµ­ì–´ + ìˆ˜í•™ + íƒêµ¬1 + íƒêµ¬2 + ì˜ì–´ + í•œêµ­ì‚¬
            const score = koreanScore + mathScore + tamgu1Score + tamgu2Score + englishScore + historyScore;

            return score;
        }

        // í•©ê²© ê°€ëŠ¥ì„± íŒì •
        function getProbability(myScore, univ) {
            if (!univ.safeScore || !univ.challengeScore) {
                return { status: 'unknown', label: 'ì •ë³´ì—†ìŒ', class: 'status-difficult', order: 5 };
            }

            if (myScore >= univ.safeScore) {
                return { status: 'safe', label: 'ì•ˆì •', class: 'status-safe', order: 1 };
            } else if (myScore >= univ.appropriateScore) {
                return { status: 'appropriate', label: 'ì ì •', class: 'status-appropriate', order: 2 };
            } else if (myScore >= univ.expectedScore) {
                return { status: 'expected', label: 'ì†Œì‹ ', class: 'status-expected', order: 3 };
            } else if (myScore >= univ.challengeScore) {
                return { status: 'challenge', label: 'ë„ì „', class: 'status-challenge', order: 4 };
            } else {
                return { status: 'difficult', label: 'ì–´ë ¤ì›€', class: 'status-difficult', order: 5 };
            }
        }

        // ê³„ì—´ ë°°ì§€ í´ë˜ìŠ¤
        function getTrackClass(track) {
            if (track === 'ìì—°') return 'track-natural';
            if (track === 'ì¸ë¬¸') return 'track-humanities';
            return 'track-combined';
        }

        // ì ìˆ˜ ë¶„ì„
        function calculateScores() {
            const korean = parseFloat(document.getElementById('korean').value) || 0;
            const koreanPct = parseInt(document.getElementById('koreanPct').value) || 0;
            const math = parseFloat(document.getElementById('math').value) || 0;
            const mathPct = parseInt(document.getElementById('mathPct').value) || 0;
            const tamgu1 = parseFloat(document.getElementById('tamgu1').value) || 0;
            const tamgu2 = parseFloat(document.getElementById('tamgu2').value) || 0;
            const tamgu1Pct = parseInt(document.getElementById('tamgu1Pct').value) || 0;
            const tamgu2Pct = parseInt(document.getElementById('tamgu2Pct').value) || 0;
            const english = parseInt(document.getElementById('english').value) || 1;
            const history = parseInt(document.getElementById('history').value) || 1;
            const tamguType = document.getElementById('tamguType').value;
            const trackFilter = document.getElementById('trackFilter').value;
            const probabilityFilter = document.getElementById('probabilityFilter').value;
            const univSearch = document.getElementById('universitySearch').value.toLowerCase().trim();
            const deptSearch = document.getElementById('departmentSearch').value.toLowerCase().trim();

            // ìš”ì•½ ì •ë³´ í‘œì‹œ
            const totalScore = korean + math + tamgu1 + tamgu2;
            const avgScore = totalScore / 4;
            document.getElementById('totalScore').textContent = totalScore.toFixed(0);
            document.getElementById('avgScore').textContent = avgScore.toFixed(1);
            document.getElementById('scoreSummary').style.display = 'flex';

            calculatedResults = [];

            universities.forEach(univ => {
                // í•„í„° ì ìš©
                if (trackFilter !== 'all' && univ.track !== trackFilter) return;
                if (univSearch && !univ.university.toLowerCase().includes(univSearch)) return;
                if (deptSearch && !univ.department.toLowerCase().includes(deptSearch)) return;

                // ë°±ì—”ë“œ ë¡œì§ ê·¸ëŒ€ë¡œ ì‚¬ìš©
                const formulaId = String(univ.formulaId);
                const formula = formulas[formulaId];
                if (!formula) return;
                
                const koreanScore = korean * formula.koreanCoef;
                const mathScore = math * formula.mathCoef;
                const tamgu1Score = tamgu1 * formula.tamguCoef + formula.tamguBonus;
                const tamgu2Score = tamgu2 * formula.tamguCoef + formula.tamguBonus;
                
                const deduction = deductions[formulaId] || {};
                const englishScore = deduction.englishDeduction || 0;
                const historyScore = (deduction.historyDeductions && history >= 1 && history <= 9) 
                    ? (deduction.historyDeductions[history - 1] || 0) 
                    : 0;
                const fixedBonus = deduction.fixedBonus || 0;
                
                const myScore = koreanScore + mathScore + tamgu1Score + tamgu2Score + englishScore + historyScore + fixedBonus;
                const probability = getProbability(myScore, univ);

                // í•©ê²©ê°€ëŠ¥ì„± í•„í„°
                if (probabilityFilter !== 'all') {
                    const filterOrder = {
                        'safe': 1,
                        'appropriate': 2,
                        'expected': 3,
                        'challenge': 4
                    };
                    if (probability.order > filterOrder[probabilityFilter]) return;
                }

                calculatedResults.push({
                    ...univ,
                    myScore: myScore,
                    probability: probability
                });
            });

            // ì§€ì› ê°€ëŠ¥ í•™ê³¼ ìˆ˜ (ë„ì „ ì´ìƒ)
            const possibleCount = calculatedResults.filter(r => r.probability.order <= 4).length;
            document.getElementById('possibleCount').textContent = possibleCount;

            // íƒ­ë³„ ê°œìˆ˜ ì—…ë°ì´íŠ¸
            document.getElementById('countGa').textContent = calculatedResults.filter(r => r.gun === 'ê°€').length;
            document.getElementById('countNa').textContent = calculatedResults.filter(r => r.gun === 'ë‚˜').length;
            document.getElementById('countDa').textContent = calculatedResults.filter(r => r.gun === 'ë‹¤').length;

            renderResults();
        }

        // íƒ­ ì „í™˜
        function switchTab(gun) {
            currentGun = gun;

            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.gun === gun);
            });

            document.getElementById('resultsTitle').textContent = `${gun}êµ° ë°°ì¹˜í‘œ`;
            renderResults();
        }

        // ê²°ê³¼ ë Œë”ë§
        function renderResults() {
            const tbody = document.getElementById('resultsBody');
            const sortBy = document.getElementById('sortBy').value;
            let filteredResults = calculatedResults.filter(r => r.gun === currentGun);

            // ì •ë ¬
            if (sortBy === 'probability') {
                filteredResults.sort((a, b) => a.probability.order - b.probability.order || b.myScore - a.myScore);
            } else if (sortBy === 'score') {
                filteredResults.sort((a, b) => b.myScore - a.myScore);
            } else if (sortBy === 'university') {
                filteredResults.sort((a, b) => a.university.localeCompare(b.university));
            }

            if (filteredResults.length === 0) {
                tbody.innerHTML = '<tr><td colspan="10" class="no-results">í•´ë‹¹í•˜ëŠ” í•™ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }

            tbody.innerHTML = filteredResults.map(r => {
                const ratioText = r.koreanRatio && r.mathRatio && r.tamguRatio
                    ? `${(r.koreanRatio * 100).toFixed(0)}/${(r.mathRatio * 100).toFixed(0)}/${(r.tamguRatio * 100 * 2).toFixed(0)}`
                    : '-';

                const scoreMethodBadge = r.scoreMethod === 'ë°±ë¶„ìœ„' ? 'ğŸ“Š' : r.scoreMethod === 'í‘œì /ë§Œì ' ? 'ğŸ“Œ' : 'ğŸ“ˆ';

                const highlightClass = r.probability.order <= 2 ? 'highlight' : '';

                return `
                    <tr class="${highlightClass}">
                        <td><strong>${r.university}</strong></td>
                        <td>${r.department}</td>
                        <td><span class="track-badge ${getTrackClass(r.track)}">${r.track}</span></td>
                        <td title="${r.scoreMethod}" style="cursor: help;">${scoreMethodBadge} ${r.myScore.toFixed(2)}</td>
                        <td class="score-cell">${r.safeScore ? r.safeScore.toFixed(1) : '-'}</td>
                        <td class="score-cell">${r.appropriateScore ? r.appropriateScore.toFixed(1) : '-'}</td>
                        <td class="score-cell">${r.expectedScore ? r.expectedScore.toFixed(1) : '-'}</td>
                        <td class="score-cell">${r.challengeScore ? r.challengeScore.toFixed(1) : '-'}</td>
                        <td><span class="${r.probability.class}">${r.probability.label}</span></td>
                        <td>${ratioText}</td>
                    </tr>
                `;
            }).join('');
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', loadData);

        // ì—”í„° í‚¤ë¡œ ë¶„ì„
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    calculateScores();
                }
            });
        });
    </script>
</body>
</html>
